# Migration `20191028214331-init`

This migration has been generated by Nicholas Kang at 10/28/2019, 9:43:31 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "lift"."User" (
  "company" TEXT    REFERENCES "Company"(id) ON DELETE SET NULL,
  "firstName" TEXT NOT NULL DEFAULT ''  ,
  "id" TEXT NOT NULL   ,
  "lastName" TEXT NOT NULL DEFAULT ''  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "lift"."Company" (
  "id" TEXT NOT NULL   ,
  "name" TEXT NOT NULL DEFAULT ''  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "lift"."BusinessUnit" (
  "company" TEXT    REFERENCES "Company"(id) ON DELETE SET NULL,
  "id" TEXT NOT NULL   ,
  "name" TEXT NOT NULL DEFAULT ''  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "lift"."Project" (
  "company" TEXT    REFERENCES "Company"(id) ON DELETE SET NULL,
  "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "id" TEXT NOT NULL   ,
  "name" TEXT NOT NULL DEFAULT ''  ,
  "owner" TEXT    REFERENCES "User"(id) ON DELETE SET NULL,
  "url" TEXT NOT NULL DEFAULT ''  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "lift"."ProjectProfile" (
  "businessUnit" TEXT    REFERENCES "BusinessUnit"(id) ON DELETE SET NULL,
  "id" TEXT NOT NULL   ,
  "project" TEXT    REFERENCES "Project"(id) ON DELETE SET NULL,
  PRIMARY KEY ("id")
);

CREATE TABLE "lift"."Spend" (
  "actualSavings" INTEGER    ,
  "baselineSpend" INTEGER NOT NULL DEFAULT 0  ,
  "forecastedSavingsAmount" INTEGER NOT NULL DEFAULT 0  ,
  "id" TEXT NOT NULL   ,
  "month" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "projectProfile" TEXT    REFERENCES "ProjectProfile"(id) ON DELETE SET NULL,
  PRIMARY KEY ("id")
);

CREATE UNIQUE INDEX "lift"."Company.name" ON "Company"("name")

CREATE UNIQUE INDEX "lift"."Project.url" ON "Project"("url")
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration ..20191028214331-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,57 @@
+generator photon {
+  provider = "photonjs"
+}
+
+datasource db {
+  provider = "sqlite"
+  url      = "file:dev.db"
+}
+
+model User {
+  id        String    @default(cuid()) @id
+  firstName String
+  lastName  String
+  projects  Project[]
+  company   Company
+}
+
+model Company {
+  id            String         @default(cuid()) @id
+  name          String         @unique
+  users         User[]
+  projects      Project[]
+  businessUnits BusinessUnit[]
+}
+
+model BusinessUnit {
+  id              String           @default(cuid()) @id
+  name            String
+  projectProfiles ProjectProfile[]
+  company         Company
+}
+
+model Project {
+  id              String           @default(cuid()) @id
+  name            String
+  url             String           @unique
+  projectProfiles ProjectProfile[]
+  owner           User
+  company         Company
+  createdAt       DateTime         @default(now())
+}
+
+model ProjectProfile {
+  id           String       @default(cuid()) @id
+  businessUnit BusinessUnit
+  project      Project
+  spend        Spend[]
+}
+
+model Spend {
+  id                      String         @default(cuid()) @id
+  month                   DateTime
+  baselineSpend           Int
+  forecastedSavingsAmount Int
+  actualSavings           Int?
+  projectProfile          ProjectProfile
+}
```

## Photon Usage

You can use a specific Photon built for this migration (20191028214331-init)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20191028214331-init'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
